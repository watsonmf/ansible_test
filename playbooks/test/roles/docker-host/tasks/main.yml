---

- include: copy_files.yml

- name: Install docker
  apt: 
    name: docker.io
    state: latest

- name: start docker service
  service:
    name: docker
    state: started

- name: build docker container
  docker_image:
    name: '{{ item }}'
    path: /tmp
    state: present
  with_items: '{{ containers }}'
  
- name: run docker container
  docker_container:
    name: '{{ item }}'
    state: started
  with_items: '{{ containers }}'
  
- name: add docker container to inventory
  add_host:
    name: '{{ item }}'
    ansible_connection: docker
    ansible_docker_extra_args: "-H tcp://10.1.1.9:19019"
    groups: containers
  with_items: '{{ containers }}'